---
title: '\LARGE \textbf {Modelos de Regreesão de Poisson Inflacionados em Zero}'
subtitle: |
          | \small ME714 | ANÁLISE DE DADOS DISCRETOS
          | \small Profa. Dra. Hildete Prisco Pinheiro
date: 2 de julho de 2021
author: | 
        | \normalsize Caroline da Silva Mangile 195539
        | \normalsize Gabriela Inocente Yogi 141812
        | \normalsize Rodrigo Resende Soares Rocha 186819
        | \normalsize Wesley R. da Silva Satelis 188650
documentclass: article
geometry: "left=2.3cm, right=2.3cm, top=2cm, bottom=2cm"
output:
  pdf_document:
    number_sections: true
    latex_engine: 'xelatex'
bibliography: "referencias.bib"
biblio-style: "plain"
link-citations: true
colorlinks: false
lang: pt-BR
fontsize: 11pt

header-includes:
- \usepackage{lineno}
# - \linenumbers
- \usepackage{subcaption}
- \usepackage{scrextend}
- \usepackage{tikz}
- \usepackage{pgfplots}
- \usetikzlibrary{shapes.geometric, arrows}
- \usepackage{caption}
- \usepackage{float}
- \pgfplotsset{compat=1.16}
# para kableExtra
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{array}
- \usepackage{multirow}
- \usepackage{wrapfig}
- \usepackage{float}
- \usepackage{colortbl}
- \usepackage{pdflscape}
- \usepackage{tabu}
- \usepackage{threeparttable}
- \usepackage{threeparttablex}
- \usepackage[normalem]{ulem}
- \usepackage{makecell}
# - \floatplacement{figure}{H}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, out.extra = "", message = F, results="hide",
                      warning = F, fig.align="center", fig.pos = "H", fig.height = 2)
```

# Introdução

**ainda tá bem ruim**

Neste trabalho são expostos conceitos teóricos a respeito dos modelos de Poisson Inflacionados em Zero (ZIP) e apresenta uma aplicação prática utilizando um conjunto de dados real. O conjunto de dados é formado por viagens de acampamento feitas por 250 grupos de pessoas à um parque nos Estados Unidos.

Foram feitas análises descritivas, diagnósticos de modelo, interpretações a respeito do problema e predição. Todo o trabalho foi conduzido com o uso da linguagem e ambiente de computação estatística R [@programaR].

# Métodos

## Distribuição de Poisson

Os dados que temos, são dados de contagem, portanto, primeiro podemos tentar utilizar o modelo de poisson que é o modelo generalizado linear mais simpes e mais utilizado para modelar esse tipo de dados. 
A distribuição de poisson é uma distribuição que possuí apenas uma moda e apenas 1 parametro U que é igual a sua média e a sua variância.

## Modelos de Poisson Inflacionados em Zero (ZIP)
Ter dados com zeros inflacionados significa que, apesar de claramente termos um modelo de contagem, é possível perceber que tem-se mais zeros do que o esperado para dados que seguem uma distribuição de poisson. Apesar da quantidade de zeros variar de acordo com a média da poisson, através do gráfico 1 fica evidente que no banco de peixe há um número de zeros maior do que o esperado. Ainda, é possivel perceber que os dados estão sobrediversados, logo a variâcia não é igual à média e as suposições do modelo de poisson é violada.
Ignorar os zeros inflacionados dos dados de contagem pode ter alguns problemas como por exemplo os paramêtros estimados e os erros serem viésados.
O modelo ZIP ajusta dois modelos de regressão, um logístico que considera os zeros em excesso e um com as contagens de interesse. Este tipo de modelo foi proposto por lambert (1992)



# Aplicação

Os dados são provenientes de 250 acampamentos familiares em um parque nos Estados Unidos. Cada grupo foi questionado sobre o número de peixes eles pegaram, quantas crianças o grupo tinha, quantas pessoas o grupo tinha, e se eles trouxeram um guia.

* **LIVE_BAIT:** Variável binária. Indica se foram usadas iscas vivas ou não;
* **CAMPER:** Variável binária. Indica se o o grupo foi acompanhado por um guia ou não;
* **PERSONS:** Variável numérica. Número de pessoas no grupo;
* **CHILDREN:** Variável numérica. Número de crianças no grupo;
* **FISH_COUNT:** Variável numérica. Número de peixes pegos pelo grupo;

\newpage

```{r}
library(tidyverse)

fish <- read_csv("banco/fish.csv")

fish <- within(fish, {
  # FISH_COUNT <- factor(FISH_COUNT)
  LIVE_BAIT <- factor(LIVE_BAIT)
  CAMPER <- factor(CAMPER)
})

```

```{r, results='hold'}
summary(fish)
```
Através das estatísticas sumárias, pode-se ter uma ideia do banco de dados. Por exemplo, pode-se ver que há pesca com iscas vivas foram maiores do que com iscas não vivas. Além disso, é possivel ver que apesar da média da peixeis pescados ser 3.286, há alguns dados que puxam essa média para esse valor, uma vez que a mediana é de 0.
```{r fig.height=2.5}
ggplot(fish, aes(FISH_COUNT)) + 
  geom_histogram(col="grey", bins=50) +
  scale_x_discrete(limits=seq(0, 150, 10)) +
  theme_bw() +
  ylab("Frequência") +
  xlab("Número de peixes")
```
Através do gráfico 1 é possível perceber que tem-se mais zeros do que o esperado para dados de contagem que seguem uma distribuição de poisson. Ainda, é possivel perceber que os dados estão sobredispersados, logo a variâcia não é igual à média e as suposições do modelo de poisson é violada.

```{r, eval=F}
ggplot(fish, aes(FISH_COUNT)) + 
  geom_histogram(col="grey") +
  scale_x_log10() +
  theme_bw() + 
  ylab("Frequência") +
  xlab("Número de peixes pegos")
```
O gráfico 2, foi realizado para saber aplicar uma transformação logaritmica na contagem de peixes seria uma opção para aplicação do modelo de poisson. Entranto, claramente os dados ainda não ficaram da forma ideal para a utilização deste tipo de modelo.
Diante disto, há indícios de que uma das opções possíves para realizar a modelagem é utilizar algum modelo do tipo ZIP, que lida melhor com essas violações.
Portanto, foi aplicado um modelo de regressão de poisson para zeros inflacionados

```{r}
## Pacotes para rodar o modelo
require("pscl")
require("boot")
library(pscl)
library(boot)
```

```{r}
summary(m1 <- zeroinfl(FISH_COUNT ~ CHILDREN + CAMPER | PERSONS, data = fish))

```
Pode-se perceber que é retornado dois modelos diferentes. O primeiro modelo ajustado foi uma regressão de poisson, enquanto que o segundo modelo corresponde ao modelo inflacionado.
Na saída dos modelos pode-se observar os coeficientes estimados, os erros padronizados e os p-valores. Neste caso, todos os preditores dos modelos demonstraram ser significantes.

Por fim, é possível realizar predições com o objetivo de prever o número de peixes pegos de acordo com as variaveis regressoras.

```{r}
newdata1 <- expand.grid(0:3, factor(0:1), 1:4)
colnames(newdata1) <- c("CHILDREN", "CAMPER", "PERSONS")
newdata1 <- subset(newdata1, subset=(CHILDREN<=PERSONS))
newdata1$phat <- predict(m1, newdata1)

ggplot(newdata1, aes(x = CHILDREN, y = phat, colour = factor(PERSONS))) +
  geom_point() +
  geom_line() +
  facet_wrap(~CAMPER) +
  labs(x = "Numero de criancas", y = "Predicao de peixes pegos")
```
Fica claro que ter crianças no grupo, faz com que o número esperado de peixe pegos seja menor do que não ter crianças no grupo.
Ainda, o número esperado de peixes pegos nos grupos que foram acampar é o dobro dos grupos que não foram acampar.

# Conclusões

# Referências

