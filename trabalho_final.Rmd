---
title: '\LARGE \textbf {Modelos de Regressão de Poisson Inflacionados em Zero}'
subtitle: |
          | \small ME714 | ANÁLISE DE DADOS DISCRETOS
          | \small Profa. Dra. Hildete Prisco Pinheiro
date: 2 de julho de 2021
author: | 
        | \normalsize Caroline da Silva Mangile 195539
        | \normalsize Gabriela Inocente Yogi 141812
        | \normalsize Rodrigo Resende Soares Rocha 186819
        | \normalsize Wesley R. da Silva Satelis 188650
documentclass: article
geometry: "left=2.3cm, right=2.3cm, top=2cm, bottom=2cm"
output:
  pdf_document:
    number_sections: true
    latex_engine: 'xelatex'
bibliography: "referencias.bib"
biblio-style: "plain"
link-citations: true
colorlinks: false
lang: pt-BR
fontsize: 11pt

header-includes:
- \usepackage{lineno}
# - \linenumbers
- \usepackage{subcaption}
- \usepackage{scrextend}
- \usepackage{tikz}
- \usepackage{pgfplots}
- \usetikzlibrary{shapes.geometric, arrows}
- \usepackage{caption}
- \usepackage{float}
- \pgfplotsset{compat=1.16}
# para kableExtra
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{array}
- \usepackage{multirow}
- \usepackage{wrapfig}
- \usepackage{float}
- \usepackage{colortbl}
- \usepackage{pdflscape}
- \usepackage{tabu}
- \usepackage{threeparttable}
- \usepackage{threeparttablex}
- \usepackage[normalem]{ulem}
- \usepackage{makecell}
# - \floatplacement{figure}{H}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, out.extra = "", message = F, results="hide",
                      warning = F, fig.align="center", fig.pos = "H", fig.height = 2)
```

# Introdução

**ainda tá bem ruim**

Neste trabalho são expostos conceitos teóricos a respeito dos modelos de Poisson Inflacionados em Zero (ZIP) e uma aplicação utilizando um conjunto de dados real. O conjunto é formado por viagens de acampamento feitas por 250 grupos de pessoas à um parque nos Estados Unidos.

Foram feitas análises descritivas, diagnósticos de modelo, interpretações a respeito do problema e predição. Todo o trabalho foi conduzido com o uso da linguagem e ambiente de computação estatística R [@programaR].

# Métodos

## Distribuição de Poisson

## Teste de superdispersão

O teste de superdispersão proposto por @cameron é baseado em uma regressão linear sem o intercepto com as hipóteses

$$
\begin{array}{c}
{H}_{0}: {Var}\left(y_{i}\right)=\lambda_{i} \ \ \ vs \ \ \ {H}_{1}: {Var}\left(y_i\right)=\lambda_{i}+\alpha {g}\left(\lambda_{i}\right)
\end{array}
$$

em que $\alpha$ é um parâmetro desconhecido e $g(.)$ é uma função definida, comumente $g(\lambda_i)=\lambda_i^2$ ou $g(\lambda_i)=\lambda_i$. Este teste é condusido estimando-se o modelo de Poisson, construindo $\hat{\lambda_i} = \exp \left(\mathrm{x}_i^{\prime} \hat{\beta}\right)$ e ajustando um modelo por mínimos quadrados ordinários sem o intercepto

$$
\frac{(y_i-\hat{\lambda_i})^2 - y_i} {\hat{\lambda_i}} = \alpha \frac{g(\hat{\lambda_i})} {\hat{\lambda_i}} + e_i
$$

em que $e_i$ é o erro. A significância do coeficiente $\alpha$ implica na existencia de superdispersão nos dados.

## Modelos de Poisson Inflacionados em Zero (ZIP)

<!-- Modelos de regressão de Poisson deve satisfazer as seguintes proposições. -->

<!-- 1. A variável resposta é uma contagem descrita pela distribuição de Poisson; -->
<!-- 2. As observações devem ser independentes umas das outras; -->
<!-- 3. Por definição, a média e variância de uma variável com distribuição de Poisson devem ser iguais; -->
<!-- 4. $log(\lambda)$ deve ser uma função linear das covariáveis. -->

Uma propriedade importante da distribuição de Poisson é que a média e variância são iguais, $Var(y_i|x_i) = E(y_i|x_i) = \lambda_i$, esta propriedade é referida como equidispersão. Na prática a suposição de equidispersão é violada quando a variância das contagens observadas é maior que a média por conta de heterogeneidade não observada ou quando a frequência de zeros é maior que o número de zeros esperado em uma distribuição de Poisson.

Assumindo que a variável resposta tem distribuição de Poissson e que o logaritmo de seu valor esperado pode ser modelado por uma combinação linear de parâmentros desconhecidos. Seja $y_i$, $i = 1, ..., n$ a variável resposta de um modelo de regressão, assumimos que $y_i$ tem distribuição de Poisson com média $\lambda_i$, definida em função das covariáveis $x_i$. Assim, um modelo de regressão de Poisson é dado por

$$
P(y_i) = \frac{e^{-\lambda_i}\lambda_i^{y_i}}{y_i!}
$$

em que a esperança condicional é dado por $\lambda_i = E(y_i|x_i) = \exp(x'\beta)$. O vetor $\mathrm{x}_{i}^{\prime} = (x_{i,1}, x_{i,2}, ..., x_{i,p})$ contem as covariáveis e $\beta^{\prime}  = (\beta_1, ..., \beta_p)$ é o vetor de parâmetros do modelo de regressão.

# Aplicação

Os dados são provenientes de 250 acampamentos familiares em um parque nos Estados Unidos. Cada grupo foi questionado sobre o número de peixes capturados, quantas pessoas o grupo tinha e quantas crianças o grupo tinha, e se eles foram acompanhados por um guia.

* **LIVE_BAIT:** Variável binária. Indica se foram usadas iscas vivas ou não;
* **CAMPER:** Variável binária. Indica se o o grupo foi acompanhado por um guia ou não;
* **PERSONS:** Variável numérica. Número de pessoas no grupo;
* **CHILDREN:** Variável numérica. Número de crianças no grupo;
* **FISH_COUNT:** Variável numérica. Número de peixes pegos pelo grupo;

<!-- teste overdispersion -->
<!-- https://stats.stackexchange.com/questions/66586/is-there-a-test-to-determine-whether-glm-overdispersion-is-significant -->


```{r}
library(tidyverse)

fish <- read_csv("banco/fish.csv")

fish <- within(fish, {
  # FISH_COUNT <- factor(FISH_COUNT)
  LIVE_BAIT <- factor(LIVE_BAIT)
  CAMPER <- factor(CAMPER)
})
```

```{r, results='hold'}
summary(fish)
```

```{r fig.height=2.5}
ggplot(fish, aes(FISH_COUNT)) + 
  geom_histogram(col="grey", bins=50) +
  scale_x_discrete(limits=seq(0, 150, 10)) +
  theme_bw() +
  ylab("Frequência") +
  xlab("Número de peixes")
```

```{r, eval=F}
ggplot(fish, aes(FISH_COUNT)) + 
  geom_histogram(col="grey") +
  scale_x_log10() +
  theme_bw() + 
  ylab("Frequência") +
  xlab("Número de peixes pegos")
```


# Conclusões

# Referências

